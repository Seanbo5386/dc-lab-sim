{
  "id": "domain1-bmc-security",
  "title": "BMC Security Hardening and Access Control",
  "domain": "domain1",
  "difficulty": "advanced",
  "description": "Learn how to secure the Baseboard Management Controller (BMC) by configuring user accounts, network security, and access controls. BMC security is critical for datacenter infrastructure protection.",
  "learningObjectives": [
    "Configure secure BMC user accounts",
    "Set up network security for BMC access",
    "Enable and configure IPMI over LAN security",
    "Configure alerting for security events",
    "Implement BMC access control best practices"
  ],
  "faults": [],
  "initialClusterState": {},
  "steps": [
    {
      "id": "step1",
      "title": "Audit Existing BMC Users",
      "description": "Review all existing BMC user accounts and their privilege levels to identify security risks.",
      "objectives": [
        "List all BMC user accounts",
        "Identify privilege levels",
        "Find default or unused accounts"
      ],
      "expectedCommands": [
        "ipmitool user list 1",
        "ipmitool channel getaccess 1"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must audit BMC users",
          "expectedCommands": ["ipmitool user list 1"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool user list 1' to list users on channel 1",
        "Privilege levels: 1=Callback, 2=User, 3=Operator, 4=Administrator",
        "Look for default 'admin' or 'ADMIN' accounts",
        "Disabled accounts show 'false' in Enable column",
        "Limit Administrator accounts to minimum necessary"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "IPMI User Management",
          "url": "https://linux.die.net/man/1/ipmitool"
        }
      ]
    },
    {
      "id": "step2",
      "title": "Configure Secure User Accounts",
      "description": "Create properly configured user accounts with appropriate privileges and strong passwords.",
      "objectives": [
        "Understand user creation commands",
        "Learn privilege assignment",
        "Know password requirements"
      ],
      "expectedCommands": ["ipmitool user list 1", "ipmitool user summary 1"],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must review user configuration options",
          "expectedCommands": [
            "ipmitool user list 1",
            "ipmitool user summary 1"
          ],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "User creation: 'ipmitool user set name <id> <username>'",
        "Password setting: 'ipmitool user set password <id>'",
        "Enable user: 'ipmitool user enable <id>'",
        "Set privilege: 'ipmitool channel setaccess 1 <id> privilege=4'",
        "Use strong passwords (12+ chars, mixed case, numbers, symbols)",
        "Create separate accounts for each administrator"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "BMC Security Best Practices",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    },
    {
      "id": "step3",
      "title": "Review BMC Network Configuration",
      "description": "Verify BMC network settings are secure and properly isolated on management network.",
      "objectives": [
        "Check BMC LAN configuration",
        "Verify network isolation",
        "Review access restrictions"
      ],
      "expectedCommands": ["ipmitool lan print 1", "ipmitool lan print"],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must review BMC network config",
          "expectedCommands": ["ipmitool lan print 1", "ipmitool lan print"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "BMC should be on isolated management network",
        "Use static IP for BMC in production",
        "VLAN tagging adds security layer",
        "Check 'IP Address Source' - Static recommended",
        "Verify 'Backup Gateway' is configured for redundancy",
        "BMC port should not be accessible from public networks"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "IPMI Network Configuration",
          "url": "https://linux.die.net/man/1/ipmitool"
        }
      ]
    },
    {
      "id": "step4",
      "title": "Configure IPMI Cipher Suites",
      "description": "Review and configure IPMI cipher suites for secure communication.",
      "objectives": [
        "Check enabled cipher suites",
        "Understand cipher security levels",
        "Learn cipher configuration"
      ],
      "expectedCommands": [
        "ipmitool lan print 1",
        "ipmitool channel getciphers ipmi 1"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must review cipher configuration",
          "expectedCommands": ["ipmitool lan print 1"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Check 'RMCP+ Cipher Suites' in lan print output",
        "Cipher 0 is no authentication - DISABLE for security",
        "Cipher 3 uses AES-CBC-128 - recommended minimum",
        "Cipher 17 uses AES-CBC-128 + SHA256 - best security",
        "Configure: 'ipmitool lan set 1 cipher_privs XXXXXaXXXXXXXXX'",
        "X=none, c=callback, u=user, o=operator, a=admin"
      ],
      "estimatedDuration": 8,
      "documentationLinks": [
        {
          "title": "IPMI Cipher Security",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    },
    {
      "id": "step5",
      "title": "Review System Event Log for Security Events",
      "description": "Check the System Event Log (SEL) for any security-related events or unauthorized access attempts.",
      "objectives": [
        "Query SEL entries",
        "Identify security events",
        "Understand event interpretation"
      ],
      "expectedCommands": ["ipmitool sel list", "ipmitool sel info"],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must review SEL",
          "expectedCommands": ["ipmitool sel list", "ipmitool sel info"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool sel info' to see SEL capacity and usage",
        "Use 'ipmitool sel list' to view all events",
        "Look for 'Session' or 'Authentication' related events",
        "Failed login attempts indicate potential security issues",
        "Regular SEL review is security best practice",
        "Clear SEL only after archiving: 'ipmitool sel clear'"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "IPMI System Event Log",
          "url": "https://linux.die.net/man/1/ipmitool"
        }
      ]
    },
    {
      "id": "step6",
      "title": "Configure BMC Alerting",
      "description": "Set up Platform Event Filtering (PEF) to alert on critical security and hardware events.",
      "objectives": [
        "Review alert configuration",
        "Understand event filtering",
        "Learn alert destinations"
      ],
      "expectedCommands": ["ipmitool pef info", "ipmitool lan alert print 1"],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must review alerting configuration",
          "expectedCommands": ["ipmitool pef info"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool pef info' to see Platform Event Filtering status",
        "PEF allows filtering and alerting on specific events",
        "SNMP traps can be sent for alerts",
        "Configure alert destination with 'ipmitool lan alert'",
        "Test alerts before relying on them in production",
        "Common events to alert: temperature, voltage, chassis intrusion"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "IPMI Alerting",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    },
    {
      "id": "step7",
      "title": "Document Security Configuration",
      "description": "Create documentation of BMC security configuration for compliance and audit purposes.",
      "objectives": [
        "Document user accounts",
        "Record network configuration",
        "Create security baseline"
      ],
      "expectedCommands": [
        "ipmitool user list 1",
        "ipmitool lan print 1",
        "ipmitool mc info"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must document security config",
          "expectedCommands": [
            "ipmitool user list 1",
            "ipmitool lan print 1",
            "ipmitool mc info"
          ],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Document all user accounts and their purposes",
        "Record network configuration including IP, gateway, VLAN",
        "Note firmware version for security patch tracking",
        "Create change management process for BMC changes",
        "Schedule regular security audits",
        "Keep documentation updated after any changes"
      ],
      "estimatedDuration": 8,
      "documentationLinks": [
        {
          "title": "DGX Security Guide",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    }
  ],
  "successCriteria": [
    "Audited existing BMC user accounts",
    "Understood secure user configuration",
    "Reviewed BMC network settings",
    "Understood cipher suite security",
    "Reviewed SEL for security events",
    "Understood alerting configuration",
    "Created security documentation"
  ],
  "estimatedTime": 45,
  "prerequisites": ["domain1-bmc-config"],
  "tags": [
    "bmc",
    "security",
    "hardening",
    "ipmi",
    "access-control",
    "advanced"
  ],
  "tier": 3,
  "commandFamilies": ["bmc-hardware"],
  "explanationGateId": "gate-domain1-bmc-security",
  "toolHints": false
}
