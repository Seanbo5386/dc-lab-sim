{
  "id": "domain1-uefi-validation",
  "title": "UEFI BIOS Settings Validation for DGX",
  "domain": "domain1",
  "difficulty": "intermediate",
  "description": "Learn how to verify and validate UEFI BIOS settings critical for optimal DGX system operation. Proper BIOS configuration ensures maximum GPU performance and system stability.",
  "learningObjectives": [
    "Verify boot order and boot device configuration",
    "Check PCIe settings for GPU operation",
    "Validate memory configuration",
    "Review power and performance settings",
    "Understand DGX-specific BIOS requirements"
  ],
  "faults": [],
  "initialClusterState": {},
  "steps": [
    {
      "id": "step1",
      "title": "Query System BIOS Information",
      "description": "Gather comprehensive BIOS information including version, vendor, and release date.",
      "objectives": [
        "Query BIOS version and vendor",
        "Check BIOS release date",
        "Verify system product info"
      ],
      "expectedCommands": [
        "dmidecode -t bios",
        "dmidecode -s bios-version",
        "dmidecode -t system"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must query BIOS information",
          "expectedCommands": ["dmidecode -t bios", "dmidecode -t system"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'dmidecode -t bios' for detailed BIOS info",
        "Use 'dmidecode -s bios-version' for just version",
        "DGX systems use specific NVIDIA-validated BIOS",
        "BIOS version should match DGX Software release",
        "Check NVIDIA release notes for compatible versions"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "DMI Decode Manual",
          "url": "https://linux.die.net/man/8/dmidecode"
        }
      ]
    },
    {
      "id": "step2",
      "title": "Verify Boot Configuration",
      "description": "Check boot order and UEFI boot configuration for proper system startup.",
      "objectives": [
        "List boot entries",
        "Verify boot order",
        "Check UEFI boot mode"
      ],
      "expectedCommands": [
        "efibootmgr -v",
        "efibootmgr",
        "ls /sys/firmware/efi"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must check boot configuration",
          "expectedCommands": ["efibootmgr -v", "efibootmgr"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'efibootmgr -v' for verbose boot entry listing",
        "Boot order shows boot device priority",
        "DGX should boot in UEFI mode, not Legacy",
        "Verify OS boot entry is first in boot order",
        "Network boot (PXE) may be used for provisioning"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "EFI Boot Manager",
          "url": "https://linux.die.net/man/8/efibootmgr"
        }
      ]
    },
    {
      "id": "step3",
      "title": "Check PCIe Topology and Configuration",
      "description": "Verify PCIe configuration including GPU slots, link width, and speed.",
      "objectives": [
        "View PCIe topology",
        "Check GPU link width and speed",
        "Verify PCIe bandwidth"
      ],
      "expectedCommands": [
        "lspci -tv",
        "lspci | grep -i nvidia",
        "nvidia-smi -q | grep -i pcie"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must verify PCIe configuration",
          "expectedCommands": ["lspci -tv", "lspci | grep -i nvidia"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'lspci -tv' for tree view of PCIe topology",
        "GPUs should show x16 link width for full bandwidth",
        "PCIe Gen4 = 16 GT/s, Gen5 = 32 GT/s",
        "All 8 GPUs should be visible in PCIe tree",
        "Check for any devices at reduced link width"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "PCIe Configuration",
          "url": "https://docs.nvidia.com/datacenter/"
        }
      ]
    },
    {
      "id": "step4",
      "title": "Verify Memory Configuration",
      "description": "Check system memory configuration including size, speed, and channel population.",
      "objectives": [
        "Query total system memory",
        "Check memory speed and type",
        "Verify memory channel population"
      ],
      "expectedCommands": [
        "dmidecode -t memory | head -50",
        "free -h",
        "lsmem"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must verify memory configuration",
          "expectedCommands": ["dmidecode -t memory", "free -h"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'dmidecode -t memory' for detailed DIMM info",
        "DGX A100 typically has 1-2TB system RAM",
        "DGX H100 typically has 2TB system RAM",
        "Memory speed should be 3200 MT/s or higher",
        "All channels should be populated for bandwidth"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "DGX Memory Specifications",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    },
    {
      "id": "step5",
      "title": "Check NUMA Topology",
      "description": "Verify NUMA configuration for optimal CPU-GPU affinity.",
      "objectives": [
        "View NUMA node topology",
        "Check CPU-GPU affinity",
        "Verify NUMA balancing settings"
      ],
      "expectedCommands": [
        "numactl --hardware",
        "nvidia-smi topo -m",
        "lscpu | grep NUMA"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must check NUMA topology",
          "expectedCommands": ["numactl --hardware", "nvidia-smi topo -m"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'numactl --hardware' for NUMA node layout",
        "Use 'nvidia-smi topo -m' for GPU-CPU affinity",
        "GPUs should be evenly distributed across NUMA nodes",
        "NUMA-aware scheduling improves performance",
        "Dual-socket systems have 2 NUMA nodes minimum"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "NUMA Configuration",
          "url": "https://docs.nvidia.com/datacenter/"
        }
      ]
    },
    {
      "id": "step6",
      "title": "Verify Power and Thermal Settings",
      "description": "Check power management and thermal configuration from BIOS perspective.",
      "objectives": [
        "Check power supply status",
        "Verify thermal sensors",
        "Review power management mode"
      ],
      "expectedCommands": [
        "ipmitool dcmi power reading",
        "ipmitool sensor list | grep -i power",
        "nvidia-smi -q | grep -i power"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must verify power settings",
          "expectedCommands": ["ipmitool dcmi power reading", "nvidia-smi -q"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "DGX A100 typical power: 6.5kW",
        "DGX H100 typical power: 10.2kW",
        "All PSUs should be present and healthy",
        "Check for power capping that may limit performance",
        "Performance mode should be enabled for max GPU power"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "DGX Power Requirements",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    },
    {
      "id": "step7",
      "title": "Validate Virtualization Settings",
      "description": "Verify virtualization extensions are enabled for container and VM workloads.",
      "objectives": [
        "Check CPU virtualization support",
        "Verify IOMMU configuration",
        "Check SR-IOV capability"
      ],
      "expectedCommands": [
        "lscpu | grep -i virtual",
        "dmesg | grep -i iommu",
        "cat /proc/cpuinfo | grep -E 'vmx|svm'"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must check virtualization settings",
          "expectedCommands": [
            "lscpu | grep -i virtual",
            "cat /proc/cpuinfo | grep vmx"
          ],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "VT-x (Intel) or AMD-V should be enabled",
        "IOMMU required for GPU passthrough",
        "SR-IOV enables NIC virtualization",
        "Container runtime requires virtualization extensions",
        "GPU passthrough requires IOMMU groups"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "Virtualization Configuration",
          "url": "https://docs.nvidia.com/datacenter/"
        }
      ]
    }
  ],
  "successCriteria": [
    "Queried BIOS version and information",
    "Verified boot configuration",
    "Checked PCIe topology",
    "Verified memory configuration",
    "Checked NUMA topology",
    "Verified power settings",
    "Validated virtualization settings"
  ],
  "estimatedTime": 37,
  "prerequisites": ["domain1-server-post"],
  "tags": [
    "uefi",
    "bios",
    "pcie",
    "memory",
    "numa",
    "validation",
    "intermediate"
  ],
  "tier": 2,
  "commandFamilies": ["bmc-hardware", "gpu-monitoring", "diagnostics"],
  "explanationGateId": "gate-domain1-uefi-validation"
}
