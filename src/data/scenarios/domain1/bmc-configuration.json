{
  "id": "domain1-bmc-config",
  "title": "BMC Configuration and Monitoring",
  "domain": "domain1",
  "difficulty": "intermediate",
  "description": "Learn how to configure and monitor the Baseboard Management Controller (BMC) on DGX systems. This scenario covers network configuration, user management, sensor monitoring, and remote management capabilities.",
  "learningObjectives": [
    "Configure BMC network settings and access",
    "Monitor system sensors (temperature, voltage, fan speed)",
    "Manage BMC users and access control",
    "Understand BMC capabilities for remote management"
  ],
  "faults": [],
  "initialClusterState": {},
  "steps": [
    {
      "id": "step1",
      "title": "Verify BMC Network Configuration",
      "description": "Check the current BMC network configuration including IP address, subnet mask, gateway, and ensure the BMC is reachable over the management network.",
      "objectives": [
        "Query BMC network configuration",
        "Verify BMC IP address is correctly assigned",
        "Test BMC network connectivity"
      ],
      "expectedCommands": ["ipmitool lan print", "ipmitool lan print 1"],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must query BMC network configuration",
          "expectedCommands": ["ipmitool lan print", "ipmitool lan print 1"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool lan print 1' to show LAN channel 1 configuration",
        "Look for 'IP Address', 'Subnet Mask', and 'Default Gateway' fields",
        "Verify the IP address is in the management network range",
        "Check that 'IP Address Source' is set appropriately (DHCP or Static)"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "IPMI LAN Configuration",
          "url": "https://linux.die.net/man/1/ipmitool"
        }
      ]
    },
    {
      "id": "step2",
      "title": "Monitor System Sensors",
      "description": "Use the BMC to monitor critical system sensors including CPU temperatures, GPU temperatures, fan speeds, voltage rails, and power consumption.",
      "objectives": [
        "Query all available sensors through BMC",
        "Identify temperature readings for critical components",
        "Check fan speeds and verify they're within normal ranges",
        "Review voltage and power consumption metrics"
      ],
      "expectedCommands": [
        "ipmitool sensor list",
        "ipmitool sdr list",
        "ipmitool dcmi power reading"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must query system sensors",
          "expectedCommands": [
            "ipmitool sensor list",
            "ipmitool sdr list",
            "ipmitool dcmi power reading"
          ],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool sensor list' to see real-time sensor readings",
        "Use 'ipmitool sdr list' for Sensor Data Record information",
        "Look for sensors with 'temp', 'fan', 'volt', or 'power' in their names",
        "Normal CPU temperatures are typically 40-80Â°C under load",
        "Fan speeds should be above 2000 RPM for proper cooling"
      ],
      "estimatedDuration": 7,
      "documentationLinks": [
        {
          "title": "IPMI Sensor Commands",
          "url": "https://linux.die.net/man/1/ipmitool"
        }
      ]
    },
    {
      "id": "step3",
      "title": "Review BMC User Accounts",
      "description": "List and review BMC user accounts, understand privilege levels, and verify that appropriate access controls are in place.",
      "objectives": [
        "List all BMC user accounts",
        "Identify privilege levels for each user",
        "Understand BMC access control model"
      ],
      "expectedCommands": ["ipmitool user list", "ipmitool user list 1"],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must list BMC users",
          "expectedCommands": ["ipmitool user list", "ipmitool user list 1"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool user list 1' to list users on channel 1",
        "Privilege levels: 1=Callback, 2=User, 3=Operator, 4=Administrator",
        "Default admin user is typically 'admin' or 'ADMIN'",
        "Ensure unused user slots are disabled for security"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "IPMI User Management",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    },
    {
      "id": "step4",
      "title": "Check BMC Firmware Version",
      "description": "Verify the BMC firmware version and compare against the latest recommended version. Understanding BMC versioning is critical for security and functionality.",
      "objectives": [
        "Query BMC firmware version",
        "Identify BMC manufacturer and device ID",
        "Document current BMC version for compliance"
      ],
      "expectedCommands": ["ipmitool mc info", "ipmitool mc guid"],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must check BMC firmware version",
          "expectedCommands": ["ipmitool mc info", "ipmitool mc guid"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool mc info' to show Management Controller information",
        "Look for 'Firmware Revision' field in the output",
        "The GUID (Globally Unique Identifier) can help track the specific BMC",
        "Compare the version against NVIDIA's BMC firmware update recommendations"
      ],
      "estimatedDuration": 3,
      "documentationLinks": [
        {
          "title": "BMC Firmware Management",
          "url": "https://docs.nvidia.com/dgx/"
        }
      ]
    },
    {
      "id": "step5",
      "title": "Configure BMC Alerting Thresholds",
      "description": "Review and understand BMC sensor thresholds that trigger alerts. Learn how to identify which thresholds are configured for critical sensors.",
      "objectives": [
        "View sensor thresholds for critical components",
        "Understand upper/lower critical and warning thresholds",
        "Identify sensors with active threshold violations"
      ],
      "expectedCommands": [
        "ipmitool sensor get \"CPU1 Temp\"",
        "ipmitool sensor thresh"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must query sensor thresholds",
          "expectedCommands": ["ipmitool sensor get", "ipmitool sensor thresh"],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool sensor get \"Sensor Name\"' to see detailed threshold info",
        "Thresholds include: Lower Non-Critical (lnc), Lower Critical (lcr), Upper Non-Critical (unc), Upper Critical (ucr)",
        "When a sensor crosses a threshold, it generates an event in the SEL",
        "Not all sensors have configurable thresholds"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "IPMI Sensor Thresholds",
          "url": "https://linux.die.net/man/1/ipmitool"
        }
      ]
    },
    {
      "id": "step6",
      "title": "Test Remote Power Management",
      "description": "Understand BMC remote power management capabilities. Learn the commands for power control and their appropriate use cases.",
      "objectives": [
        "Query current system power state",
        "Understand available power control commands",
        "Learn when to use soft vs hard power operations"
      ],
      "expectedCommands": [
        "ipmitool chassis power status",
        "ipmitool chassis status"
      ],
      "validationRules": [
        {
          "type": "command-executed",
          "description": "Must query power status",
          "expectedCommands": [
            "ipmitool chassis power status",
            "ipmitool chassis status"
          ],
          "requireAllCommands": true
        }
      ],
      "hints": [
        "Use 'ipmitool chassis power status' to see if system is on/off",
        "Use 'ipmitool chassis status' for detailed chassis information",
        "Power commands include: on, off, cycle, reset, soft",
        "NEVER execute power off/reset commands in production without authorization",
        "Soft shutdown is preferred over hard power off"
      ],
      "estimatedDuration": 5,
      "documentationLinks": [
        {
          "title": "IPMI Chassis Commands",
          "url": "https://linux.die.net/man/1/ipmitool"
        }
      ]
    }
  ],
  "successCriteria": [
    "Successfully verified BMC network configuration",
    "Monitored all critical system sensors",
    "Reviewed BMC user accounts and privilege levels",
    "Verified BMC firmware version",
    "Understood sensor threshold configuration",
    "Learned remote power management capabilities"
  ],
  "estimatedTime": 30,
  "prerequisites": ["domain1-server-post"],
  "tags": [
    "bmc",
    "ipmi",
    "monitoring",
    "sensors",
    "remote-management",
    "intermediate"
  ],
  "tier": 2,
  "commandFamilies": ["bmc-hardware"],
  "explanationGateId": "gate-domain1-bmc-config"
}
